{% extends "base.html" %}
{% load static %}

{% block content %}
<main id="main" class="main">

  <div class="pagetitle">
    <h1>Главная</h1>
    <nav>
      <ol class="breadcrumb">
        <li class="breadcrumb-item active">Главная</li>
      </ol>
    </nav>
  </div>

  <section class="section">
    <div class="row">

      <div class="col-lg-8">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title mb-2">Добро пожаловать, {{ user.get_username }}</h5>
            <p class="text-muted mb-0">
              Здесь можно разместить FAQ / инструкции по работе с модулями приложения.
            </p>

            <hr>

            <div class="alert alert-info mb-0">
              <div class="fw-semibold mb-1">Быстрый старт</div>
              <ul class="mb-0">
                <li>Открой нужный раздел слева в меню.</li>
                <li>Если видишь 403 — значит не хватает прав (обратись к администратору).</li>
                <li>FAQ/инструкции можно будет расширять прямо на этой странице.</li>
              </ul>
            </div>

          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <h5 class="card-title">Разделы</h5>

            <div class="list-group">

              {% if user.is_superuser or perms.passports_app.view_passports_page %}
              <a href="{% url 'passports_list' %}" class="list-group-item list-group-item-action">
                <i class="bi bi-journal-text me-2"></i> Паспорта
              </a>
              {% endif %}

              {% if user.is_superuser or perms.projects_app.view_projects_page %}
              <a href="{% url 'projects:projects_list' %}" class="list-group-item list-group-item-action">
                <i class="bi bi-hdd-stack me-2"></i> Проекты
              </a>
              {% endif %}

              {% if user.is_superuser or perms.directive_app.view_directives_page %}
              <a href="{% url 'list_directive' %}" class="list-group-item list-group-item-action">
                <i class="bi bi-person-square me-2"></i> Приказы
              </a>
              {% endif %}

              {% if user.is_superuser or perms.approvals_app.view_approvals_done_page %}
              <a href="{% url 'approvals:done' %}" class="list-group-item list-group-item-action">
                <i class="bi bi-briefcase-fill me-2"></i> Согласования
              </a>
              {% endif %}

              {% if user.is_superuser or perms.checker_app.check_projects_and_folder_page %}
              <a href="{% url 'checker_app_check_projects_and_folder' %}" class="list-group-item list-group-item-action">
                <i class="bi bi-check-circle me-2"></i> Checker — проверка шифра в актах
              </a>
              {% endif %}

              {% if user.is_superuser or perms.checker_app.check_doc_acts_page %}
              <a href="{% url 'check_doc_acts' %}" class="list-group-item list-group-item-action">
                <i class="bi bi-file-earmark-text me-2"></i> Checker — поиск .doc актов
              </a>
              {% endif %}

              {% if not user.is_superuser and not perms.passports_app.view_passports_page and not perms.projects_app.view_projects_page and not perms.directive_app.view_directives_page and not perms.approvals_app.view_approvals_done_page and not perms.checker_app.check_projects_and_folder_page and not perms.checker_app.check_doc_acts_page %}
              <div class="list-group-item text-muted">
                У вас пока нет доступных разделов. Обратитесь к администратору.
              </div>
              {% endif %}

            </div>

          </div>
        </div>
      </div>

      <div class="col-lg-4">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">Аккаунт</h5>
            <div class="small text-muted">Пользователь</div>
            <div class="fw-semibold">{{ user.get_username }}</div>

            <hr>

            <div class="small text-muted">Роль</div>
            <div class="fw-semibold">
              {% if user.is_superuser %}
                Superuser
              {% elif user.is_staff %}
                Staff
              {% else %}
                User
              {% endif %}
            </div>

            <hr>

            <a href="{% url 'authapp:logout' %}" class="btn btn-outline-danger w-100">
              <i class="bi bi-box-arrow-right me-1"></i> Выйти
            </a>
          </div>
        </div>

        {% if user.is_superuser %}
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">Администрирование</h5>
            <a href="{% url 'admin:index' %}" class="btn btn-outline-primary w-100">
              <i class="bi bi-shield-lock me-1"></i> Открыть админку
            </a>
          </div>
        </div>
        {% endif %}
      </div>

    </div>
  </section>

</main>
{% endblock %}
